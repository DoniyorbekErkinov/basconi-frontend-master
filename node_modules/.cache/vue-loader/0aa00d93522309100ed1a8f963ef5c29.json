{"remainingRequest":"P:\\noenter\\basconi-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!P:\\noenter\\basconi-frontend-master\\src\\modules\\wms\\warehouse\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"P:\\noenter\\basconi-frontend-master\\src\\modules\\wms\\warehouse\\index.vue","mtime":1652787130000},{"path":"P:\\noenter\\basconi-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695882313197},{"path":"P:\\noenter\\basconi-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1695882545643}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBEZXBhcnRtZW50U2VydmljZSBmcm9tICIuLi8uLi9tYW5hZ2VtZW50L2RlcGFydG1lbnQvZGVwYXJ0bWVudC5zZXJ2aWNlIjsKaW1wb3J0IFdhcmVIYXNlU2VydmljZSBmcm9tICIuL3dhcmVob3VzZS5zZXJ2aWNlIjsKaW1wb3J0IFVzZXJzU2VydmljZSBmcm9tICIuLi8uLi9tYW5hZ2VtZW50L3VzZXJzL3VzZXJzLnNlcnZpY2UiOwppbXBvcnQge1Rva2VuU2VydmljZX0gZnJvbSAiLi4vLi4vLi4vc2VydmljZXMvc3RvcmFnZS5zZXJ2aWNlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiaW5kZXgiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpdGVtczogW10sCiAgICAgIHN5bmM6IHRydWUsCiAgICAgIHRvdGFsSXRlbXM6IDAsCiAgICAgIGNvbHVtbnM6IFsKICAgICAgICB7bmFtZTogJ2lkJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuaW5kZXgnKSwgZmllbGQ6ICdpbmRleCd9LAogICAgICAgIHtuYW1lOiAnYnJhbmROYW1lJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuYnJhbmQnKSwgZmllbGQ6ICdicmFuZE5hbWUnfSwKICAgICAgICB7bmFtZTogJ2NhdGVnb3J5TmFtZScsIGFsaWduOiAnY2VudGVyJywgbGFiZWw6IHRoaXMuJHQoJ2l0ZW1zLmNhdGVnb3J5JyksIGZpZWxkOiAnY2F0ZWdvcnlOYW1lJ30sCiAgICAgICAge25hbWU6ICdjb2xvcicsIGFsaWduOiAnY2VudGVyJywgbGFiZWw6IHRoaXMuJHQoJ2l0ZW1zLmNvbG9ycycpLCBmaWVsZDogJ2NvbG9yTmFtZSd9LAogICAgICAgIHtuYW1lOiAnY2t1JywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuc2t1JyksIGZpZWxkOiAnaXRlbUNrdSd9LAogICAgICAgIHtuYW1lOiAnc2l6ZUlkJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuc2l6ZScpLCBmaWVsZDogJ3NpemVPbGNoYW0nfSwKICAgICAgICB7bmFtZTogJ2RlcGFydG1lbnROYW1lJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuZGVwYXJ0bWVudE5hbWUnKSwgZmllbGQ6ICdkZXBhcnRtZW50TmFtZSd9LAogICAgICAgIHtuYW1lOiAncmVtYWluaW5nJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMucmVtYWluaW5nJyksIGZpZWxkOiAncmVtYWluaW5nJ30sCiAgICAgICAge25hbWU6ICdwcmljZScsIGFsaWduOiAnY2VudGVyJywgbGFiZWw6IHRoaXMuJHQoJ2l0ZW1zLnByaWNlJyksIGZpZWxkOiAncHJpY2UnfSwKICAgICAgICB7bmFtZTogJ2luY29tZVByaWNlJywgYWxpZ246ICdjZW50ZXInLCBsYWJlbDogdGhpcy4kdCgnaXRlbXMuaW5jb21lX3ByaWNlJyksIGZpZWxkOiAnaW5jb21lUHJpY2UnfSwKICAgICAgICAvLyB7bmFtZTogJ25hbWUnLCBhbGlnbjogJ2NlbnRlcicsIGxhYmVsOiB0aGlzLiR0KCdpdGVtcy5uYW1lJyksIGZpZWxkOiAnaXRlbU5hbWUnfSwKICAgICAgXSwKICAgICAgdmlzaWJsZUNvbHVtbnM6IFsnaWQnLCAnYnJhbmROYW1lJywgJ2NhdGVnb3J5TmFtZScsICdjb2xvcicsICdja3UnLCAnc2l6ZUlkJywgJ2RlcGFydG1lbnROYW1lJywgJ3JlbWFpbmluZycsICdwcmljZScsICdpbmNvbWVQcmljZSddLAogICAgICB2aXNpYmxlQ29sdW1uczE6IFsnaWQnLCAnYnJhbmROYW1lJywgJ2NhdGVnb3J5TmFtZScsICdjb2xvcicsICdja3UnLCAnc2l6ZUlkJywgJ2RlcGFydG1lbnROYW1lJywgJ3JlbWFpbmluZycsICdwcmljZSddLAogICAgICBzZWFyY2g6ICcnLAogICAgICB3aW5kb3dXaWR0aDogd2luZG93LmlubmVyV2lkdGgsCiAgICAgIHBheWxvYWQ6IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIGxpbWl0OiAyMAogICAgICB9LAogICAgICBkZXBJZHM6IFtdLAogICAgICBkZXBhcnRtZW50TGlzdDogW10sCiAgICAgIHVzZXJJbmZvOiB7fSwKICAgICAgdmlzaWJsZTogZmFsc2UKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBtYXhJdGVtKCkgewogICAgICBsZXQgbWF4ID0gdGhpcy50b3RhbEl0ZW1zIC8gdGhpcy5wYXlsb2FkLmxpbWl0CiAgICAgIHJldHVybiBNYXRoLmNlaWwobWF4KQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICdzZWFyY2gnOiB7CiAgICAgIGhhbmRsZXIoZSkgewogICAgICAgIHRoaXMuZmlsdGVyKCk7CiAgICAgIH0KICAgIH0sCiAgICAncGF5bG9hZC5wYWdlJzogewogICAgICBoYW5kbGVyKGUpIHsKICAgICAgICB0aGlzLmZpbHRlcigpOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRVc2VyUm9sZSgpIHsKICAgICAgbGV0IHVzZXIgPSBUb2tlblNlcnZpY2UuZ2V0VXNlckluZm8oKQogICAgICBVc2Vyc1NlcnZpY2UuZ2V0VXNlcnNCeUlkKHVzZXIuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLnVzZXJJbmZvID0gcmVzLmRhdGEKICAgICAgfSkKICAgIH0sCiAgICBwYWdpbmF0ZShpdGVtc1BlclBhZ2UsIGN1cnJlbnRQYWdlLCBpbmRleCkgewogICAgICBjdXJyZW50UGFnZSA9IGN1cnJlbnRQYWdlIC0gMQogICAgICByZXR1cm4gaXRlbXNQZXJQYWdlICogY3VycmVudFBhZ2UgKyAoaW5kZXggKyAxKQogICAgfSwKICAgIGZpbHRlcigpIHsKICAgICAgdGhpcy5wYXlsb2FkLmRlcElkcyA9IHRoaXMuZGVwSWRzCiAgICAgIGlmKHRoaXMuJGNhbignVmlldycsICdJbmNvbWVQcmljZScpKSB7CiAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZQogICAgICAgIFdhcmVIYXNlU2VydmljZS5nZXRJdGVtc0RvY3ModGhpcy5zZWFyY2gsIHRoaXMucGF5bG9hZCkudGhlbihyZXMgPT4gewogICAgICAgICAgdGhpcy5pdGVtcyA9IHJlcy5kYXRhLmxpc3QKICAgICAgICAgIHRoaXMudG90YWxJdGVtcyA9cmVzLmRhdGEudG90YWwKICAgICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICAgIHRoaXMuJHZzLm5vdGlmaWNhdGlvbih7CiAgICAgICAgICAgIHR5cGU6J2NvbmZpcm0nLAogICAgICAgICAgICBkdXJhdGlvbjogMTAwMCwKICAgICAgICAgICAgdGl0bGU6IGUubWVzc2FnZSwKICAgICAgICAgICAgcHJvZ3Jlc3M6ICdhdXRvJywKICAgICAgICAgICAgY29sb3I6ICdkYW5nZXInLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1yaWdodCcKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZQogICAgICAgIFdhcmVIYXNlU2VydmljZS5nZXRJdGVtc0RvY3NGb3JTYWxlcih0aGlzLnNlYXJjaCwgdGhpcy5wYXlsb2FkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICB0aGlzLml0ZW1zID0gcmVzLmRhdGEubGlzdAogICAgICAgICAgdGhpcy50b3RhbEl0ZW1zID1yZXMuZGF0YS50b3RhbAogICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgdGhpcy4kdnMubm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgdHlwZTonY29uZmlybScsCiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLAogICAgICAgICAgICB0aXRsZTogZS5tZXNzYWdlLAogICAgICAgICAgICBwcm9ncmVzczogJ2F1dG8nLAogICAgICAgICAgICBjb2xvcjogJ2RhbmdlcicsCiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLXJpZ2h0JwogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICB9CiAgICB9LAogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGF3YWl0ICBEZXBhcnRtZW50U2VydmljZS5nZXREZXBhcnRtZW50c0xpc3QoKS50aGVuKHJlcyA9PiB7CiAgICAgIHRoaXMuZGVwYXJ0bWVudExpc3QgPSBbXQogICAgICB0aGlzLmRlcGFydG1lbnRMaXN0ID0gcmVzLmRhdGEKICAgICAgdGhpcy5kZXBJZHMgPSBbXQogICAgICB0aGlzLmRlcGFydG1lbnRMaXN0LmZvckVhY2goZGVwID0+IHsKICAgICAgICB0aGlzLmRlcElkcy5wdXNoKGRlcC5pZCkKICAgICAgfSkKICAgIH0pLmNhdGNoKGUgPT4gewogICAgICB0aGlzLiR2cy5ub3RpZmljYXRpb24oewogICAgICAgIHR5cGU6J2NvbmZpcm0nLAogICAgICAgIHRpdGxlOiBlLm1lc3NhZ2UsCiAgICAgICAgZHVyYXRpb246IDEwMDAsCiAgICAgICAgcHJvZ3Jlc3M6ICdhdXRvJywKICAgICAgICBjb2xvcjogJ2RhbmdlcicsCiAgICAgICAgcG9zaXRpb246ICd0b3AtcmlnaHQnCiAgICAgIH0pCiAgICB9KQogICAgdGhpcy5nZXRVc2VyUm9sZSgpCiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA+DA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/modules/wms/warehouse","sourcesContent":["<template>\n  <div>\n    <q-table\n        :data=\"items\"\n        row-key=\"id\"\n        row=\"row\"\n        class=\"shadow-10\"\n        :columns=\"columns\"\n        :visible-columns=\"visible ? visibleColumns : visibleColumns1\"\n        :hide-pagination=\"true\"\n        :rows-per-page-options=\"[0]\"\n    >\n      <template v-slot:top>\n        <div v-if=\"windowWidth > 600\" class=\"q-table__title\">{{ $t('wms.warehouse.title') }}</div>\n        <q-space v-if=\"windowWidth > 600\"/>\n        <vs-select :key=\"`departmentList-${departmentList.length}`\" v-model=\"depIds\" :placeholder=\"$t('doc.department')\" multiple class=\"mr-1 mb-1\">\n            <vs-option v-for=\"(dep, i) in departmentList\" :key=\"`departments-${i}`\" :label=\"dep.name\" :value=\"dep.id\" >\n               {{ dep.name }}\n            </vs-option>\n        </vs-select>\n        <vs-input state=\"primary\" v-model=\"search\" primary icon-after class=\"mr-1\" :placeholder=\"$t('actions.search')\">\n          <template #icon>\n            <q-icon name=\"search\"/>\n          </template>\n        </vs-input>\n        <q-space v-if=\"windowWidth < 600\"/>\n        <vs-button dark icon animation-type=\"rotate\" @click=\"filter\">\n          <q-icon name=\"search\"/>\n        </vs-button>\n        <q-separator/>\n      </template>\n      <template v-if=\"windowWidth < 600\" v-slot:item=\"props\" class=\"row items-center\">\n        <div class=\"row items-center ml-4\">\n          <q-expansion-item\n            v-for=\"item in items\"\n            :key=\"item.id\"\n            :label=\"`${item.brandName} / ${item.itemCku} / ${item.sizeOlcham}`\"\n            style=\"border-radius: 10px;\"\n            expand-icon-class=\"text-white\"\n            header-class=\"bg-primary text-white\"\n            class=\"shadow-24 overflow-hidden mt-1 mr-2\"\n          >\n            <q-card dense>\n              <q-card-section class=\"col\">\n                <div class=\"text-left ml-1\"><b>{{ $t('items.brand') }}:</b> <span class=\"text-subtitle-2\">{{ item.brandName}}</span></div>\n                <hr/>\n                <div class=\"text-left ml-1\"><b>{{ $t('items.sku') }}:</b> <span class=\"text-subtitle-2\">{{ item.itemCku}}</span></div>\n              </q-card-section>\n            </q-card>\n          </q-expansion-item>\n        </div>\n      </template>\n      <template v-slot:body-cell-id=\"props\">\n        <q-td class=\"text-center\">{{ paginate(payload.limit, payload.page, props.rowIndex) }}</q-td>\n      </template>\n    </q-table>\n    <div class=\"row justify-center q-mt-md\">\n      <q-pagination v-model=\"payload.page\" :max=\"maxItem\" :max-pages=\"4\" direction-links boundary-links push/>\n    </div>\n  </div>\n</template>\n\n<script>\nimport DepartmentService from \"../../management/department/department.service\";\nimport WareHaseService from \"./warehouse.service\";\nimport UsersService from \"../../management/users/users.service\";\nimport {TokenService} from \"../../../services/storage.service\";\n\nexport default {\n  name: \"index\",\n  data() {\n    return {\n      items: [],\n      sync: true,\n      totalItems: 0,\n      columns: [\n        {name: 'id', align: 'center', label: this.$t('items.index'), field: 'index'},\n        {name: 'brandName', align: 'center', label: this.$t('items.brand'), field: 'brandName'},\n        {name: 'categoryName', align: 'center', label: this.$t('items.category'), field: 'categoryName'},\n        {name: 'color', align: 'center', label: this.$t('items.colors'), field: 'colorName'},\n        {name: 'cku', align: 'center', label: this.$t('items.sku'), field: 'itemCku'},\n        {name: 'sizeId', align: 'center', label: this.$t('items.size'), field: 'sizeOlcham'},\n        {name: 'departmentName', align: 'center', label: this.$t('items.departmentName'), field: 'departmentName'},\n        {name: 'remaining', align: 'center', label: this.$t('items.remaining'), field: 'remaining'},\n        {name: 'price', align: 'center', label: this.$t('items.price'), field: 'price'},\n        {name: 'incomePrice', align: 'center', label: this.$t('items.income_price'), field: 'incomePrice'},\n        // {name: 'name', align: 'center', label: this.$t('items.name'), field: 'itemName'},\n      ],\n      visibleColumns: ['id', 'brandName', 'categoryName', 'color', 'cku', 'sizeId', 'departmentName', 'remaining', 'price', 'incomePrice'],\n      visibleColumns1: ['id', 'brandName', 'categoryName', 'color', 'cku', 'sizeId', 'departmentName', 'remaining', 'price'],\n      search: '',\n      windowWidth: window.innerWidth,\n      payload: {\n        page: 1,\n        limit: 20\n      },\n      depIds: [],\n      departmentList: [],\n      userInfo: {},\n      visible: false\n    }\n  },\n  computed: {\n    maxItem() {\n      let max = this.totalItems / this.payload.limit\n      return Math.ceil(max)\n    }\n  },\n  watch: {\n    'search': {\n      handler(e) {\n        this.filter();\n      }\n    },\n    'payload.page': {\n      handler(e) {\n        this.filter();\n      }\n    }\n  },\n  methods: {\n    getUserRole() {\n      let user = TokenService.getUserInfo()\n      UsersService.getUsersById(user.id).then(res => {\n        this.userInfo = res.data\n      })\n    },\n    paginate(itemsPerPage, currentPage, index) {\n      currentPage = currentPage - 1\n      return itemsPerPage * currentPage + (index + 1)\n    },\n    filter() {\n      this.payload.depIds = this.depIds\n      if(this.$can('View', 'IncomePrice')) {\n        this.visible = true\n        WareHaseService.getItemsDocs(this.search, this.payload).then(res => {\n          this.items = res.data.list\n          this.totalItems =res.data.total\n        }).catch(e => {\n          this.$vs.notification({\n            type:'confirm',\n            duration: 1000,\n            title: e.message,\n            progress: 'auto',\n            color: 'danger',\n            position: 'top-right'\n          })\n        })\n      } else {\n        this.visible = false\n        WareHaseService.getItemsDocsForSaler(this.search, this.payload).then(res => {\n          this.items = res.data.list\n          this.totalItems =res.data.total\n        }).catch(e => {\n          this.$vs.notification({\n            type:'confirm',\n            duration: 1000,\n            title: e.message,\n            progress: 'auto',\n            color: 'danger',\n            position: 'top-right'\n          })\n        })\n      }\n    },\n  },\n  async created() {\n    await  DepartmentService.getDepartmentsList().then(res => {\n      this.departmentList = []\n      this.departmentList = res.data\n      this.depIds = []\n      this.departmentList.forEach(dep => {\n        this.depIds.push(dep.id)\n      })\n    }).catch(e => {\n      this.$vs.notification({\n        type:'confirm',\n        title: e.message,\n        duration: 1000,\n        progress: 'auto',\n        color: 'danger',\n        position: 'top-right'\n      })\n    })\n    this.getUserRole()\n  }\n}\n</script>\n\n<style scoped>\n</style>\n"]}]}